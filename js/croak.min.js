function createContainer(e){e&&(window.croakAPP.buttonsParam=!0);let t=document.createElement("div");return document.body.append(t),t.classList.add("stories-container"),setTimeout((()=>{t.classList.add("stories-container_active")}),100),t}function createGallery(e){let t=document.createElement("div");return t.classList.add("galleri"),t.style.setProperty("--galleri-gap",e),t.classList.add("galleri-opened"),t}function createElements(e,t,i,l,r){e.forEach((e=>{let o=document.createElement("div");if(r&&window.innerWidth>=768?(o.classList.add("galleri__el"),o.classList.add("galleri__el_stories"),o.style.setProperty("--img-scale",i)):(o.classList.add("galleri__el"),o.style.setProperty("--img-scale",i)),e.hasAttribute("data-video-el")){let i=document.createElement("video"),s=document.createElement("source"),a=document.createElement("source");l&&(window.innerWidth<=768?(s.setAttribute("src",e.getAttribute("data-src-mob-mp4")),a.setAttribute("src",e.getAttribute("data-src-mob-webm")),i.muted="muted",i.style.width="100%",i.controls=!0):(s.setAttribute("src",e.getAttribute("data-src-mp4")),s.setAttribute("type","video/mp4"),a.setAttribute("src",e.getAttribute("data-src-webm")),a.setAttribute("type","video/webm"))),r&&(s.setAttribute("src",e.getAttribute("data-src-mob-mp4")),s.setAttribute("type","video/mp4"),a.setAttribute("src",e.getAttribute("data-src-mob-webm")),a.setAttribute("type","video/webm")),r||l||(s.setAttribute("src",e.getAttribute("data-src-mp4")),s.setAttribute("type","video/mp4"),a.setAttribute("src",e.getAttribute("data-src-webm")),a.setAttribute("type","video/webm")),i.setAttribute("loop",!0),i.setAttribute("playsinline",!0),i.appendChild(s),i.appendChild(a),i.setAttribute("preload",!0),o.append(i),t.append(o)}else{let i=document.createElement("img");i.setAttribute("src",e.getAttribute("src")),o.append(i),t.append(o)}}))}function createExitBtn(){let e=document.createElement("button");e.classList.add("close-gallery");const t=(new DOMParser).parseFromString('<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M5.63599 18.364L18.3639 5.63603M5.63599 5.63604L18.3639 18.364" stroke="black" stroke-width="1.5" stroke-linecap="round"/></svg>',"image/svg+xml").querySelector("svg");return e.append(t),e}function createNextButton(e,t,i){if(window.croakAPP.buttonsParam){let l=document.querySelector(i).querySelector(".stories-next").cloneNode();return e.appendChild(l),l.classList.add("custom-right"),window.croakAPP.activeSlide==t.querySelectorAll(".galleri__el").length-1&&(l.setAttribute("disabled",!0),l.classList.add("btn_disabled")),l}}function createPrevButton(e,t,i){if(window.croakAPP.buttonsParam){let t=document.querySelector(i).querySelector(".stories-prev").cloneNode();return e.appendChild(t),t.classList.add("custom-left"),0==window.croakAPP.activeSlide&&(t.setAttribute("disabled",!0),t.classList.add("btn_disabled")),t}}function clickGalleri(e){document.querySelectorAll(".galleri .galleri__el").forEach(((t,i)=>{t.addEventListener("click",(t=>{if(document.querySelectorAll(".galleri .galleri__el").forEach((e=>{e.classList.remove("stories-el_active")})),window.croakAPP.activeSlide=i,t.currentTarget.classList.add("stories-el_active"),galleriSwipe(t.currentTarget,e),window.croakAPP.buttonsParam){let t=e.parentElement.parentElement,i=t.querySelector(".stories-prev"),l=t.querySelector(".stories-next");0==window.croakAPP.activeSlide?(i.setAttribute("disabled",!0),i.classList.add("btn_disabled")):(i.removeAttribute("disabled"),i.classList.remove("btn_disabled")),window.croakAPP.activeSlide==e.querySelectorAll(".galleri__el").length-1?(l.setAttribute("disabled",!0),l.classList.add("btn_disabled")):(l.removeAttribute("disabled"),l.classList.remove("btn_disabled"))}}))}))}function galleriSwipe(e,t,i){let l=e.getBoundingClientRect().right;e.parentElement.querySelectorAll("video").forEach((e=>{e.removeAttribute("autoplay"),e.pause()})),void 0===i&&(i=!1);let r=e.querySelector("video");r&&e.classList.contains("stories-el_active")&&(r.setAttribute("autoplay",!0),r.play());let o=t.getBoundingClientRect().width/2-l;const s=t.getBoundingClientRect(),a=e.getBoundingClientRect();let n=-(o+s.left+a.width/2);t.style.transform=`translate3d(${-Math.round(n)}px, -50%, 0)`;let d=t.scrollWidth,c=t.parentElement,u=c.clientWidth,m=0,w=!1,b=-n,p=0,v=0,g=u-d-a.width-a.width/2,h=-(d-u+a.width+a.width/2);function y(){setTimeout((()=>{t.classList.add("galleri_transform"),t.style.transform=`translate3d(${-Math.round(n)}px, -50%, 0)`;let e=t.querySelectorAll(".galleri__el")[window.croakAPP.activeSlide];e.classList.add("stories-el_active"),e.querySelector("video")&&e.querySelector("video").play()}),200),w=!1,t.style.cursor="grab",b=-p,t.querySelectorAll(".galleri__el").forEach((e=>{e.style.pointerEvents="initial"})),v=0}window.innerWidth>=768&&window.deskSwipe&&(c.addEventListener("mousedown",(function(e){e.preventDefault(),t.style.cursor="grabbing",w=!0,m=e.clientX})),c.addEventListener("mousemove",(function(e){if(e.preventDefault(),!w)return;0===v&&(b=-n,t.querySelectorAll(".galleri__el").forEach(((e,t,i)=>{e.classList.remove("stories-el_active"),e.style.pointerEvents="none",e.parentElement.querySelectorAll("video").forEach((e=>{e.removeAttribute("autoplay"),e.pause()}))})),t.classList.remove("galleri_transform"),v++),p=m-e.clientX-b;let i=-p;p<h&&(p+=i+(h+20)),i<g&&(p+=i-(g-20)),window.deskSwipeFocus&&t.querySelectorAll(".galleri__el").forEach(((e,i,l)=>{if(function(e){let t=e.getBoundingClientRect().left+e.getBoundingClientRect().width/2;return t<=window.innerWidth/2+e.getBoundingClientRect().width/window.elementScale/2&&t>=window.innerWidth/2-e.getBoundingClientRect().width/window.elementScale/2}(e)){let l=t.getBoundingClientRect().width/2-e.getBoundingClientRect().right;const r=t.getBoundingClientRect(),o=e.getBoundingClientRect();n=-(l+r.left+o.width/2),window.croakAPP.activeSlide=i}})),t.style.transform=`translate3d(${-p}px, -50%, 0)`})),c.addEventListener("mouseup",y),c.addEventListener("mouseleave",y)),window.innerWidth<=768&&window.deskSwipe&&t.classList.add("galleri_transform")}function nextClick(e){let t=e.querySelectorAll(".galleri .galleri__el").length;if(document.querySelectorAll(".galleri .galleri__el").forEach((e=>{e.classList.remove("stories-el_active")})),window.croakAPP.buttonsParam){let i=e.parentElement.parentElement;if(window.croakAPP.activeSlide<=1){let e=i.querySelector(".stories-prev");e.removeAttribute("disabled"),e.classList.remove("btn_disabled"),e.classList.add("stories-el_active")}if(window.croakAPP.activeSlide===t-2){let e=i.querySelector(".stories-next");e.setAttribute("disabled",!0),e.classList.add("btn_disabled")}}if(window.croakAPP.activeSlide<t-1){window.croakAPP.activeSlide+=1;let t=e.querySelectorAll(".galleri .galleri__el")[window.croakAPP.activeSlide];t.classList.add("stories-el_active"),galleriSwipe(t,e)}}function prevClick(e){if(window.croakAPP.buttonsParam){let t=e.querySelectorAll(".galleri .galleri__el").length,i=e.parentElement.parentElement,l=i.querySelector(".stories-next"),r=i.querySelector(".stories-prev");window.croakAPP.activeSlide===t-1&&(l.removeAttribute("disabled"),l.classList.remove("btn_disabled")),1===window.croakAPP.activeSlide&&(r.setAttribute("disabled",!0),r.classList.add("btn_disabled"))}if(document.querySelectorAll(".galleri .galleri__el").forEach((e=>{e.classList.remove("stories-el_active")})),0!=window.croakAPP.activeSlide){window.croakAPP.activeSlide-=1;let t=e.querySelectorAll(".galleri .galleri__el")[window.croakAPP.activeSlide];t.classList.add("stories-el_active"),galleriSwipe(t,e)}}function clickExit(e,t,i,l,r,o,s,a){e.addEventListener("click",(()=>{deleteGalleri(t,i,l,r,o,s,a)}))}function remClassContainer(e){return new Promise((t=>{e.classList.remove("stories-container_active"),t()}))}function remFromBody(e){document.body.removeChild(e)}async function delContainer(e){await remClassContainer(e),setTimeout((()=>{remFromBody(e)}),300)}function deleteGalleri(e,t,i,l,r,o,s){if(document.removeEventListener("keydown",r),0,0,document.removeEventListener("touchstart",o),document.removeEventListener("touchend",s),window.croakAPP.activeSlide=void 0,delContainer(i),enableScroll(),l.classList.remove("galleri_transform"),window.croakAPP.buttonsParam){let e=l.parentElement.parentElement,t=e.querySelector(".stories-prev"),i=e.querySelector(".stories-next");setTimeout((()=>{t.removeAttribute("disabled"),t.classList.remove("btn_disabled"),i.removeAttribute("disabled"),i.classList.remove("btn_disabled"),window.croakAPP.buttonsParam=!1}),300)}}let scrollPosition=0,bodyEl=document.querySelector("body");function disableScroll(){scrollPosition=window.pageYOffset,bodyEl.style.overflow="hidden",bodyEl.style.position="fixed",bodyEl.style.top=`-${scrollPosition}px`,bodyEl.style.width="100%"}function enableScroll(){bodyEl.style.removeProperty("overflow"),bodyEl.style.removeProperty("position"),bodyEl.style.removeProperty("top"),bodyEl.style.removeProperty("width"),window.scrollTo(0,scrollPosition)}const heightControl=()=>{document.documentElement.style.setProperty("--app-height",`${window.innerHeight}px`)};export class croakSlider{constructor(e){window.croakAPP={activeSlide:void 0,buttonsParam:!1},this.stories=!1,this.keyboard=!1,this.buttons=!1,this.gap,this.scale,this.opacity,this.DOMElement,this.mobileVideo=!1,this.deskStories=!1,this.deskSwipeFocus=!1,this.deskSwipe=!1,this.clickGalleri=!1,e.DOMElement&&(this.DOMElement=e.DOMElement),e.buttons&&(window.croakAPP.buttonsParam=!0,this.buttons=!0),e.keyboard&&(this.keyboard=e.keyboard),e.gap&&(this.gap=`${e.gap}px`),e.scale&&(this.scale=e.scale,window.elementScale=this.scale),e.opacity&&(this.opacity=e.opacity),!0===e.mobileVideo&&(this.mobileVideo=!0),!0===e.deskStories&&(this.deskStories=!0),!0===e.deskSwipe&&(window.deskSwipe=!0),!0===e.deskSwipeFocus&&(window.deskSwipeFocus=!0),!0===e.clickGalleri&&(this.clickGalleri=!0),this.DOMElement&&document.querySelectorAll(this.DOMElement).forEach((e=>{e.querySelectorAll("[data-el], [data-video-el]").forEach(((e,t,i)=>{e.addEventListener("click",(()=>{window.croakAPP.activeSlide=t,setTimeout((()=>{disableScroll()}),350);let e=createGallery(this.gap);createElements(i,e,this.scale,this.mobileVideo,this.deskStories);let l=createExitBtn(),r=createContainer(this.buttons),o=document.createElement("div");o.classList.add("stories-wrapper"),this.deskStories||o.classList.add("galleri-fullsize"),r.appendChild(o),o.appendChild(e),r.appendChild(l),r.style.setProperty("--galleri-opacity",this.opacity),e&&(document.querySelectorAll(".galleri .galleri__el").forEach((e=>{e.classList.remove("stories-el_active")})),e.querySelectorAll(".galleri .galleri__el")[window.croakAPP.activeSlide].classList.add("stories-el_active"),galleriSwipe(e.querySelectorAll(".galleri .galleri__el")[window.croakAPP.activeSlide],e,this.deskSwipe),setTimeout((()=>{e.classList.add("galleri_transform")}),200));let s=50,a=0,n=0;function d(e){a=e.touches[0].clientX,n=e.touches[0].clientY}function c(t){let i=t.changedTouches[0].clientX,l=t.changedTouches[0].clientY,r=a-i,o=n-l;if(Math.abs(r-o)>0&&Math.abs(r)>s)if(r>0){if(window.croakAPP.activeSlide===e.querySelectorAll(".galleri__el").length-1)return;nextClick(e)}else if(r<0){if(0===window.croakAPP.activeSlide)return;prevClick(e)}}function u(t){"ArrowRight"===t.key&&nextClick(e),"ArrowLeft"===t.key&&prevClick(e),"d"===t.key&&nextClick(e),"a"===t.key&&prevClick(e),"Escape"===t.key&&deleteGalleri(a,n,r,e,u,d,c)}if(clickExit(l,a,n,r,e,u,d,c),this.buttons){let t=createNextButton(r,e,this.DOMElement),i=createPrevButton(r,e,this.DOMElement);t.addEventListener("click",(()=>{nextClick(e)})),i.addEventListener("click",(()=>{prevClick(e)}))}this.keyboard&&(document.addEventListener("keydown",u),window.innerWidth<=768&&document.removeEventListener("keydown",u)),document.addEventListener("touchstart",d),document.addEventListener("touchend",c),this.clickGalleri&&clickGalleri(e)}))}))}))}}heightControl(),window.addEventListener("resize",heightControl);